--overall sold 
select prod_name,sum(no_of_product)as total_sold from sales where prod_name!="" group by prod_name order by total_sold desc;

--top 5 sold
select prod_name,sum(no_of_product)as total_sold from sales where prod_name!="" group by prod_name order by total_sold desc limit5;

--most sold
select prod_name,sum(no_of_product)as total_sold from sales where prod_name!="" group by prod_name order by total_sold desc limit1;

--daily sales volume
select date,sum(no_of_product)as total_prod_sold from sales where prod_name !=""group by date order by date;

--product-wise revenue
select prod_name,sum(price) as total_revenue from sales where prod_name !="" group by prod_name order by total_revenue desc;


--compare import quantity vs sold quantity
SELECT i.imp_item, 
       i.stock_level AS imported_qty,
       COALESCE(SUM(s.no_of_product), 0) AS sold_qty,
       (i.stock_level - COALESCE(SUM(s.no_of_product), 0)) AS remaining_stock
FROM import i
LEFT JOIN sales s ON LOWER(i.imp_item) = LOWER(s.prod_name)
GROUP BY i.imp_item, i.stock_level
ORDER BY sold_qty DESC;